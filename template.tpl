___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Customer.io",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Use this Tag to send data to Customer.io using the Data Pipelines API.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "type",
    "displayName": "Type",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "trackEvent",
        "displayValue": "Track Event"
      },
      {
        "value": "trackPageView",
        "displayValue": "Track Page View"
      },
      {
        "value": "trackScreenView",
        "displayValue": "Track Screen View"
      },
      {
        "value": "identifyUser",
        "displayValue": "Identify User"
      },
      {
        "value": "addUserToGroup",
        "displayValue": "Add User to Group"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "trackEvent",
    "alwaysInSummary": true,
    "subParams": [
      {
        "type": "GROUP",
        "name": "trackEventGroup",
        "subParams": [
          {
            "type": "RADIO",
            "name": "eventType",
            "displayName": "Event Name Setup Method",
            "radioItems": [
              {
                "value": "standard",
                "displayValue": "Standard",
                "subParams": [
                  {
                    "type": "SELECT",
                    "name": "eventNameStandard",
                    "selectItems": [
                      {
                        "value": "Promotion Viewed",
                        "displayValue": "Promotion Viewed"
                      },
                      {
                        "value": "Promotion Clicked",
                        "displayValue": "Promotion Clicked"
                      },
                      {
                        "value": "Products Searched",
                        "displayValue": "Products Searched"
                      },
                      {
                        "value": "Product List Viewed",
                        "displayValue": "Product List Viewed"
                      },
                      {
                        "value": "Product List Filtered",
                        "displayValue": "Product List Filtered"
                      },
                      {
                        "value": "Product Clicked",
                        "displayValue": "Product Clicked"
                      },
                      {
                        "value": "Product Viewed",
                        "displayValue": "Product Viewed"
                      },
                      {
                        "value": "Product Added",
                        "displayValue": "Product Added"
                      },
                      {
                        "value": "Product Removed",
                        "displayValue": "Product Removed"
                      },
                      {
                        "value": "Cart Viewed",
                        "displayValue": "Cart Viewed"
                      },
                      {
                        "value": "Checkout Started",
                        "displayValue": "Checkout Started"
                      },
                      {
                        "value": "Checkout Step Viewed",
                        "displayValue": "Checkout Step Viewed"
                      },
                      {
                        "value": "Checkout Step Completed",
                        "displayValue": "Checkout Step Completed"
                      },
                      {
                        "value": "Payment Info Entered",
                        "displayValue": "Payment Info Entered"
                      },
                      {
                        "value": "Order Completed",
                        "displayValue": "Order Completed"
                      },
                      {
                        "value": "Order Updated",
                        "displayValue": "Order Updated"
                      },
                      {
                        "value": "Order Refunded",
                        "displayValue": "Order Refunded"
                      },
                      {
                        "value": "Order Cancelled",
                        "displayValue": "Order Cancelled"
                      },
                      {
                        "value": "Coupon Entered",
                        "displayValue": "Coupon Entered"
                      },
                      {
                        "value": "Coupon Applied",
                        "displayValue": "Coupon Applied"
                      },
                      {
                        "value": "Coupon Denied",
                        "displayValue": "Coupon Denied"
                      },
                      {
                        "value": "Coupon Removed",
                        "displayValue": "Coupon Removed"
                      },
                      {
                        "value": "Product Added to Wishlist",
                        "displayValue": "Product Added to Wishlist"
                      },
                      {
                        "value": "Product Removed from Wishlist",
                        "displayValue": "Product Removed from Wishlist"
                      },
                      {
                        "value": "Wishlist Product Added to Cart",
                        "displayValue": "Wishlist Product Added to Cart"
                      },
                      {
                        "value": "Product Shared",
                        "displayValue": "Product Shared"
                      },
                      {
                        "value": "Cart Shared",
                        "displayValue": "Cart Shared"
                      },
                      {
                        "value": "Product Reviewed",
                        "displayValue": "Product Reviewed"
                      },
                      {
                        "value": "Application Installed",
                        "displayValue": "Application Installed"
                      },
                      {
                        "value": "Application Opened",
                        "displayValue": "Application Opened"
                      },
                      {
                        "value": "Application Backgrounded",
                        "displayValue": "Application Backgrounded"
                      },
                      {
                        "value": "Application Foregrounded",
                        "displayValue": "Application Foregrounded"
                      },
                      {
                        "value": "Application Updated",
                        "displayValue": "Application Updated"
                      },
                      {
                        "value": "Application Uninstalled",
                        "displayValue": "Application Uninstalled"
                      },
                      {
                        "value": "Application Crashed",
                        "displayValue": "Application Crashed"
                      }
                    ],
                    "simpleValueType": true,
                    "displayName": "Event Name",
                    "valueValidators": [
                      {
                        "type": "NON_EMPTY"
                      }
                    ],
                    "alwaysInSummary": true
                  }
                ],
                "help": "Only \u003ca href\u003d\"https://docs.customer.io/api/cdp/#section/Semantic-events\"\u003eSemantic Events\u003c/a\u003e for \u003ci\u003eEcommerce\u003c/i\u003e and \u003ci\u003eMobile App\u003c/i\u003e are shown. Use the \u003cb\u003eCustom\u003c/b\u003e option for other cases."
              },
              {
                "value": "inherit",
                "subParams": [],
                "displayValue": "Inherit from client",
                "help": "Provides partial event mapping. Not all GA4 events can be mapped to Customer.io events."
              },
              {
                "value": "custom",
                "subParams": [
                  {
                    "type": "TEXT",
                    "name": "eventNameCustom",
                    "simpleValueType": true,
                    "valueValidators": [
                      {
                        "type": "NON_EMPTY"
                      }
                    ],
                    "displayName": "Event Name"
                  }
                ],
                "displayValue": "Custom",
                "help": "You can choose from \u003ca href\u003d\"https://docs.customer.io/api/cdp/#section/Semantic-events\"\u003eSemantic Events\u003c/a\u003e or enter a custom event name."
              }
            ],
            "simpleValueType": true,
            "defaultValue": "standard"
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "trackEvent",
            "type": "EQUALS"
          }
        ]
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "apiKey",
    "displayName": "API Key",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "To find your API Key go to:\u003cbr\u003e Workspace \u003e Data \u0026 Integrations \u003e Integrations \u003e Customer.io API (\u003cb\u003enot\u003c/b\u003e \"Customer.io API: Track\") \u003e Settings"
  },
  {
    "type": "SELECT",
    "name": "apiRegion",
    "displayName": "Account Region",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "eu",
        "displayValue": "European Union (EU)"
      },
      {
        "value": "us",
        "displayValue": "United States of America (US)"
      }
    ],
    "simpleValueType": true,
    "help": "If you don\u0027t know your account\u0027s region, you can find it on \u003ca href\u003d\"https://fly.customer.io/settings/privacy\"\u003eyour account\u0027s privacy page\u003c/a\u003e, or \u003ca href\u003d\"https://docs.customer.io/api/track/?region\u003deu#operation/getRegion\"\u003eget your region using the API\u003c/a\u003e.",
    "defaultValue": "eu"
  },
  {
    "type": "TEXT",
    "name": "userId",
    "displayName": "User ID",
    "simpleValueType": true,
    "help": "The unique identifier for a person.\n\u003cbr\u003e\nYou can use the User Email, if a User ID is not available."
  },
  {
    "type": "TEXT",
    "name": "anonymousId",
    "displayName": "Anonymous ID",
    "simpleValueType": true,
    "help": "A unique substitute for a User ID in cases when you don’t have an absolute unique identifier.\n\u003cbr\u003e\nUsually this is a Browser ID or a Device ID or a Pseudo ID (e.g. GA4 \u003ci\u003e_ga\u003c/i\u003e Client ID cookie or Stape Data Client \u003ci\u003e_dcid\u003c/i\u003e cookie)."
  },
  {
    "type": "SELECT",
    "name": "generateAnonymousIdCookie",
    "displayName": "Generate Anonymous ID cookie (Web only)",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": false,
        "displayValue": "false"
      },
      {
        "value": true,
        "displayValue": "true"
      }
    ],
    "simpleValueType": true,
    "help": "If no Anonymous ID is set in the template:\n\u003cul\u003e\u003cli\u003eUse the Anonymous ID from Customer.io JS SDK \u003ci\u003eajs_anonymous_id\u003c/i\u003e, if the cookie exists\u003c/li\u003e\n\u003cli\u003eor, if the cookie doesn\u0027t exist, generate a new Anonymous ID value and save it in the cookie\u003c/li\u003e\n\u003c/ul\u003e",
    "subParams": [
      {
        "type": "GROUP",
        "name": "anonIdCookieSettingsGroup",
        "displayName": "Cookie Settings",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "anonIdCookieDomain",
            "displayName": "Cookie Domain",
            "simpleValueType": true,
            "defaultValue": "auto",
            "valueHint": "example.com",
            "help": "Enable this option to override the cookie domain. \u003cbr\u003e Enter your website\u0027s top-level domain as a fixed value (e.g., example.com). \u003cbr\u003e If left unchecked, the top-level domain will be automatically determined using the following priority: \u003cul\u003e \u003cli\u003eTop-level domain of the \u003ci\u003eForwarded\u003c/i\u003e header (if present).\u003c/li\u003e \u003cli\u003eTop-level domain of the \u003ci\u003eX-Forwarded-Host\u003c/i\u003e header (if present).\u003c/li\u003e \u003cli\u003eTop-level domain of the \u003ci\u003eHost\u003c/i\u003e header.\u003c/li\u003e \u003c/ul\u003e",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "anonIdCookieExpiration",
            "displayName": "Cookie Expiration",
            "simpleValueType": true,
            "defaultValue": 365,
            "valueUnit": "days",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "generateAnonymousIdCookie",
            "paramValue": false,
            "type": "NOT_EQUALS"
          }
        ]
      }
    ]
  },
  {
    "type": "SELECT",
    "name": "redactIpAddress",
    "displayName": "Redact Visitor IP Address",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": true,
        "displayValue": "true"
      },
      {
        "value": false,
        "displayValue": "false"
      }
    ],
    "simpleValueType": true,
    "defaultValue": false,
    "help": "Removes the visitor\u0027s IP address from the event data.\nUse with caution, enabling this may negatively impact reporting accuracy and data quality."
  },
  {
    "type": "CHECKBOX",
    "name": "useOptimisticScenario",
    "checkboxText": "Use Optimistic Scenario",
    "simpleValueType": true,
    "help": "The tag will call gtmOnSuccess() without waiting for a response from the API. This will speed up sGTM response time however your tag will always return the status fired successfully even in case it is not."
  },
  {
    "type": "GROUP",
    "name": "propertiesGroup",
    "subParams": [
      {
        "type": "GROUP",
        "name": "commonPropertiesGroup",
        "displayName": "Common Properties",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "TEXT",
            "name": "messageId",
            "displayName": "Message ID",
            "simpleValueType": true,
            "help": "A unique identifier for a Data Pipelines call, ensuring that each individual event is unique. It\u0027s helpful if you want to deduplicate events. The first event with a given Message ID received will be accepted, and any other event with the same Message ID will be ignored for the next 12 hours.\n\u003cbr\u003e\u003cbr\u003e\nIf not set, this value will be automatically set for you."
          },
          {
            "type": "TEXT",
            "name": "timestamp",
            "displayName": "Timestamp",
            "simpleValueType": true,
            "help": "Specify the client event property to populate the event time (in \u003ca href\u003d\"https://en.wikipedia.org/wiki/ISO_8601\"\u003eISO-8601 format\u003c/a\u003e), or leave it empty to use the current time."
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "contextPropertiesGroup",
        "displayName": "Context Properties",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "LABEL",
            "name": "contextPropertiesListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/common-fields/#the-context-object\"\u003ehelp page\u003c/a\u003e for a description of each property part the \u003ci\u003econtext\u003c/i\u003e object and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "contextPropertiesList",
            "displayName": "",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "SELECT",
                "isUnique": true,
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ],
                "selectItems": [
                  {
                    "value": "active",
                    "displayValue": "active"
                  },
                  {
                    "value": "ip",
                    "displayValue": "ip"
                  },
                  {
                    "value": "locale",
                    "displayValue": "locale"
                  },
                  {
                    "value": "userAgent",
                    "displayValue": "userAgent"
                  },
                  {
                    "value": "channel",
                    "displayValue": "channel"
                  },
                  {
                    "value": "campaign",
                    "displayValue": "campaign (Web only)"
                  },
                  {
                    "value": "page",
                    "displayValue": "page (Web only)"
                  },
                  {
                    "value": "app",
                    "displayValue": "app (App only)"
                  },
                  {
                    "value": "device",
                    "displayValue": "device (App only)"
                  },
                  {
                    "value": "network",
                    "displayValue": "network (App only)"
                  },
                  {
                    "value": "os",
                    "displayValue": "os (App only)"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "userTraitsGroup",
        "displayName": "User Traits",
        "groupStyle": "ZIPPY_OPEN",
        "subParams": [
          {
            "type": "SELECT",
            "name": "userTraitsObject",
            "displayName": "User Traits Object",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Provide an object with User Traits to merge with the fields below. Any conflicting traits will be overwritten.",
            "notSetText": "(not set)"
          },
          {
            "type": "LABEL",
            "name": "userTraitsListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/identify-spec/#traits\"\u003ehelp page\u003c/a\u003e for a description of each predefined \u003ci\u003etrait\u003c/i\u003e and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "userTraitsList",
            "displayName": "Predefined User Traits",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "SELECT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "createdAt",
                    "displayValue": "createdAt (ISO 8601 date-time string)"
                  },
                  {
                    "value": "email",
                    "displayValue": "email"
                  },
                  {
                    "value": "unsubscribed",
                    "displayValue": "unsubscribed"
                  },
                  {
                    "value": "address",
                    "displayValue": "address"
                  },
                  {
                    "value": "age",
                    "displayValue": "age"
                  },
                  {
                    "value": "avatar",
                    "displayValue": "avatar"
                  },
                  {
                    "value": "birthday",
                    "displayValue": "birthday"
                  },
                  {
                    "value": "company",
                    "displayValue": "company"
                  },
                  {
                    "value": "description",
                    "displayValue": "description"
                  },
                  {
                    "value": "firstName",
                    "displayValue": "firstName"
                  },
                  {
                    "value": "lastName",
                    "displayValue": "lastName"
                  },
                  {
                    "value": "name",
                    "displayValue": "name"
                  },
                  {
                    "value": "phone",
                    "displayValue": "phone"
                  },
                  {
                    "value": "title",
                    "displayValue": "title"
                  },
                  {
                    "value": "username",
                    "displayValue": "username"
                  },
                  {
                    "value": "website",
                    "displayValue": "website"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "customUserTraitsList",
            "displayName": "Custom User Traits",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "foo bar",
                    "displayValue": "foo bar"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "valueValidators": []
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "identifyUser",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "groupTraitsGroup",
        "displayName": "Group Traits",
        "groupStyle": "ZIPPY_OPEN",
        "subParams": [
          {
            "type": "TEXT",
            "name": "groupId",
            "displayName": "Group ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "SELECT",
            "name": "groupTraitsObject",
            "displayName": "Group Traits Object",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Provide an object with Group Traits to merge with the fields below. Any conflicting traits will be overwritten.",
            "notSetText": "(not set)"
          },
          {
            "type": "LABEL",
            "name": "groupTraitsListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/group-spec/#traits\"\u003ehelp page\u003c/a\u003e for a description of each predefined \u003ci\u003etrait\u003c/i\u003e and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "groupTraitsList",
            "displayName": "Predefined Group Traits",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "SELECT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "createdAt",
                    "displayValue": "createdAt (ISO 8601 date-time string)"
                  },
                  {
                    "value": "email",
                    "displayValue": "email"
                  },
                  {
                    "value": "address",
                    "displayValue": "address"
                  },
                  {
                    "value": "avatar",
                    "displayValue": "avatar"
                  },
                  {
                    "value": "industry",
                    "displayValue": "industry"
                  },
                  {
                    "value": "employees",
                    "displayValue": "employees"
                  },
                  {
                    "value": "description",
                    "displayValue": "description"
                  },
                  {
                    "value": "name",
                    "displayValue": "name"
                  },
                  {
                    "value": "phone",
                    "displayValue": "phone"
                  },
                  {
                    "value": "title",
                    "displayValue": "title"
                  },
                  {
                    "value": "website",
                    "displayValue": "website"
                  },
                  {
                    "value": "plan",
                    "displayValue": "plan"
                  },
                  {
                    "value": "relationshipAttributes",
                    "displayValue": "relationshipAttributes"
                  },
                  {
                    "value": "objectId",
                    "displayValue": "objectId"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "customGroupTraitsList",
            "displayName": "Custom Group Traits",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "foo bar",
                    "displayValue": "foo bar"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "valueValidators": []
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "addUserToGroup",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "pageViewPropertiesGroup",
        "displayName": "Page View Properties",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "TEXT",
            "name": "pageViewPageNameProperty",
            "displayName": "Page Name",
            "simpleValueType": true
          },
          {
            "type": "SELECT",
            "name": "pageViewPropertiesObject",
            "displayName": "Page View Properties Object",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Provide an object with Page View Properties to merge with the fields below. Any conflicting properties will be overwritten.",
            "notSetText": "(not set)"
          },
          {
            "type": "LABEL",
            "name": "pageViewPropertiesListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/page-spec/#page-properties\"\u003ehelp page\u003c/a\u003e for a description of each property that is part of the \u003ci\u003eproperties\u003c/i\u003e object and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "pageViewPropertiesList",
            "displayName": "Page View Predefined Properties",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "SELECT",
                "isUnique": true,
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ],
                "selectItems": [
                  {
                    "value": "category",
                    "displayValue": "category"
                  },
                  {
                    "value": "url",
                    "displayValue": "url"
                  },
                  {
                    "value": "title",
                    "displayValue": "title"
                  },
                  {
                    "value": "referrer",
                    "displayValue": "referrer"
                  },
                  {
                    "value": "path",
                    "displayValue": "path"
                  },
                  {
                    "value": "search",
                    "displayValue": "search"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "pageViewCustomPropertiesList",
            "displayName": "Page View Custom Properties",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "foo bar",
                    "displayValue": "foo bar"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "valueValidators": []
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "trackPageView",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "screenViewPropertiesGroup",
        "displayName": "Screen View Properties",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "TEXT",
            "name": "screenViewScreenNameProperty",
            "displayName": "Screen Name",
            "simpleValueType": true
          },
          {
            "type": "SELECT",
            "name": "screenViewPropertiesObject",
            "displayName": "Screen View Properties Object",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Provide an object with Screen View Properties to merge with the fields below. Any conflicting properties will be overwritten.",
            "notSetText": "(not set)"
          },
          {
            "type": "LABEL",
            "name": "screenViewPropertiesListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/screen-spec/#complete-payload\"\u003ehelp page\u003c/a\u003e for a description of each property that is part of the \u003ci\u003eproperties\u003c/i\u003e object and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "screenViewCustomPropertiesList",
            "displayName": "Screen View Custom Properties",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "foo bar",
                    "displayValue": "foo bar"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "valueValidators": []
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "trackScreenView",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "eventPropertiesGroup",
        "displayName": "Event Properties",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "TEXT",
            "name": "itemIdKey",
            "displayName": "Custom Item ID Key",
            "simpleValueType": true,
            "help": "You can specify a custom key, which will be used to set the content Item ID, by default \u003ci\u003eitem_id\u003c/i\u003e will be used. This may be useful if you are using WooCommerce extensions.",
            "canBeEmptyString": true
          },
          {
            "type": "SELECT",
            "name": "eventPropertiesObject",
            "displayName": "Event Properties Object",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "Provide an object with Event Properties to merge with the fields below. Any conflicting properties will be overwritten.",
            "notSetText": "(not set)"
          },
          {
            "type": "LABEL",
            "name": "eventPropertiesListLabel",
            "displayName": "Check this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/source-spec/track-spec/#properties\"\u003ehelp page (\"track\")\u003c/a\u003e and this \u003ca href\u003d\"https://docs.customer.io/cdp/sources/semantic-events/ecommerce/#event-lifecycles\"\u003ehelp page (Semantic Ecommerce Events)\u003c/a\u003e for a description of each property that is part of the \u003ci\u003eproperties\u003c/i\u003e object and its expected type and value."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "eventPropertiesList",
            "displayName": "Event Properties",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "SELECT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "value",
                    "displayValue": "value"
                  },
                  {
                    "value": "query",
                    "displayValue": "query"
                  },
                  {
                    "value": "products",
                    "displayValue": "products"
                  },
                  {
                    "value": "list_id",
                    "displayValue": "list_id"
                  },
                  {
                    "value": "category",
                    "displayValue": "category"
                  },
                  {
                    "value": "filters",
                    "displayValue": "filters"
                  },
                  {
                    "value": "sorts",
                    "displayValue": "sorts"
                  },
                  {
                    "value": "promotion_id",
                    "displayValue": "promotion_id"
                  },
                  {
                    "value": "creative",
                    "displayValue": "creative"
                  },
                  {
                    "value": "name",
                    "displayValue": "name"
                  },
                  {
                    "value": "position",
                    "displayValue": "position"
                  },
                  {
                    "value": "cart_id",
                    "displayValue": "cart_id"
                  },
                  {
                    "value": "checkout_id",
                    "displayValue": "checkout_id"
                  },
                  {
                    "value": "step",
                    "displayValue": "step"
                  },
                  {
                    "value": "shipping_method",
                    "displayValue": "shipping_method"
                  },
                  {
                    "value": "payment_method",
                    "displayValue": "payment_method"
                  },
                  {
                    "value": "order_id",
                    "displayValue": "order_id"
                  },
                  {
                    "value": "affiliation",
                    "displayValue": "affiliation"
                  },
                  {
                    "value": "revenue",
                    "displayValue": "revenue"
                  },
                  {
                    "value": "shipping",
                    "displayValue": "shipping"
                  },
                  {
                    "value": "tax",
                    "displayValue": "tax"
                  },
                  {
                    "value": "discount",
                    "displayValue": "discount"
                  },
                  {
                    "value": "coupon",
                    "displayValue": "coupon"
                  },
                  {
                    "value": "currency",
                    "displayValue": "currency"
                  },
                  {
                    "value": "subtotal",
                    "displayValue": "subtotal"
                  },
                  {
                    "value": "total",
                    "displayValue": "total"
                  },
                  {
                    "value": "coupon_id",
                    "displayValue": "coupon_id"
                  },
                  {
                    "value": "coupon_name",
                    "displayValue": "coupon_name"
                  },
                  {
                    "value": "reason",
                    "displayValue": "reason"
                  },
                  {
                    "value": "wishlist_name",
                    "displayValue": "wishlist_id"
                  },
                  {
                    "value": "share_via",
                    "displayValue": "share_via"
                  },
                  {
                    "value": "share_message",
                    "displayValue": "share_message"
                  },
                  {
                    "value": "recipient",
                    "displayValue": "recipient"
                  },
                  {
                    "value": "review_id",
                    "displayValue": "review_id"
                  },
                  {
                    "value": "review_body",
                    "displayValue": "review_body"
                  },
                  {
                    "value": "rating",
                    "displayValue": "rating"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "eventCustomPropertiesList",
            "displayName": "Event Custom Properties",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": [
                  {
                    "value": "foo bar",
                    "displayValue": "foo bar"
                  }
                ],
                "valueValidators": [
                  {
                    "type": "NON_EMPTY"
                  }
                ]
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "valueValidators": []
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "type",
            "paramValue": "trackEvent",
            "type": "EQUALS"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "consentSettingsGroup",
    "displayName": "Consent Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "adStorageConsent",
        "displayName": "",
        "radioItems": [
          {
            "value": "optional",
            "displayValue": "Send data always"
          },
          {
            "value": "required",
            "displayValue": "Send data in case marketing consent given"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "optional"
      }
    ]
  },
  {
    "displayName": "Logs Settings",
    "name": "logsGroup",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "debug"
      }
    ]
  },
  {
    "displayName": "BigQuery Logs Settings",
    "name": "bigQueryLogsGroup",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "type": "RADIO",
        "name": "bigQueryLogType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log to BigQuery"
          },
          {
            "value": "always",
            "displayValue": "Log to BigQuery"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "no"
      },
      {
        "type": "GROUP",
        "name": "logsBigQueryConfigGroup",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "logBigQueryProjectId",
            "displayName": "BigQuery Project ID",
            "simpleValueType": true,
            "help": "Optional.  \u003cbr\u003e\u003cbr\u003e  If omitted, it will be retrieved from the environment variable \u003cI\u003eGOOGLE_CLOUD_PROJECT\u003c/i\u003e where the server container is running. If the server container is running on Google Cloud, \u003cI\u003eGOOGLE_CLOUD_PROJECT\u003c/i\u003e will already be set to the Google Cloud project\u0027s ID."
          },
          {
            "type": "TEXT",
            "name": "logBigQueryDatasetId",
            "displayName": "BigQuery Dataset ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "logBigQueryTableId",
            "displayName": "BigQuery Table ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "bigQueryLogType",
            "paramValue": "always",
            "type": "EQUALS"
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const getAllEventData = require('getAllEventData');
const JSON = require('JSON');
const generateRandom = require('generateRandom');
const getCookieValues = require('getCookieValues');
const getTimestampMillis = require('getTimestampMillis');
const getContainerVersion = require('getContainerVersion');
const logToConsole = require('logToConsole');
const getRequestHeader = require('getRequestHeader');
const makeString = require('makeString');
const makeInteger = require('makeInteger');
const sendHttpRequest = require('sendHttpRequest');
const setCookie = require('setCookie');
const getType = require('getType');
const BigQuery = require('BigQuery');
const toBase64 = require('toBase64');

/**********************************************************************************************/

const traceId = getRequestHeader('trace-id');

const eventData = getAllEventData();

if (!isConsentGivenOrNotRequired()) {
  return data.gtmOnSuccess();
}

const url = eventData.page_location || getRequestHeader('referer');
if (url && url.lastIndexOf('https://gtm-msr.appspot.com/', 0) === 0) {
  return data.gtmOnSuccess();
}

const actionHandlers = {
  trackPageView: trackPageView,
  trackScreenView: trackScreenView,
  trackEvent: trackEvent,
  identifyUser: identifyUser,
  addUserToGroup: addUserToGroup
};

const handler = actionHandlers[data.type];
if (handler) {
  let mappedData = {};
  mappedData = addCommonProperties(data, eventData, mappedData); // Present in all requests
  mappedData = addContext(data, eventData, mappedData); // Present in all requests
  handler(data, eventData, mappedData);
} else {
  return data.gtmOnFailure();
}

if (data.useOptimisticScenario) {
  return data.gtmOnSuccess();
}

/**********************************************************************************************/
// Vendor related functions

function addCommonProperties(data, eventData, mappedData) {
  if (data.messageId) mappedData.messageId = data.messageId;
  if (data.timestamp) mappedData.timestamp = data.timestamp;

  if (data.userId) mappedData.userId = data.userId;
  if (data.anonymousId) mappedData.anonymousId = data.anonymousId;
  else if (isUIFieldTrue(data.generateAnonymousIdCookie)) {
    const anonymousId = getCookieValues('ajs_anonymous_id')[0] || generateUUID();
    mappedData.anonymousId = anonymousId;
    const cookieOptions = {
      domain: data.anonIdCookieDomain || 'auto',
      samesite: 'Lax',
      path: '/',
      secure: true,
      httpOnly: false,
      'max-age': 60 * 60 * 24 * (makeInteger(data.anonIdCookieExpiration) || 365)
    };
    setCookie('ajs_anonymous_id', anonymousId, cookieOptions);
  }

  return mappedData;
}

function addContext(data, eventData, mappedData) {
  const context = {
    // The API ignores empty objects.
    campaign: {},
    page: {},
    app: {},
    device: {},
    network: {},
    os: {},
    library: {
      name: 'gtmserver-stape',
      version: '1.0'
    }
  };

  if (eventData.ip_override) context.ip = eventData.ip_override;
  if (isUIFieldTrue(data.redactIpAddress)) context.ip = '0.0.0.0';

  if (eventData.user_agent) context.userAgent = eventData.user_agent;

  if (eventData.language) context.locale = eventData.language;

  if (eventData.page_path) context.page.path = eventData.page_path;
  if (eventData.page_referrer) context.page.referrer = eventData.page_referrer;
  if (eventData.page_title) context.page.title = eventData.page_title;
  if (eventData.page_location) context.page.url = eventData.page_location;

  if (eventData.app_id) context.app.name = eventData.app_id;
  if (eventData.app_version) context.app.version = eventData.app_version;

  if (eventData['x-ga-device_model']) context.device.model = eventData['x-ga-device_model'];
  // Firebase - IDFA (iOS) or GAID (Google) || IDFV (iOS)
  if (eventData['x-ga-resettable_device_id'] || eventData['x-ga-vendor_device_id']) {
    context.device.advertisingId =
      eventData['x-ga-resettable_device_id'] || eventData['x-ga-vendor_device_id'];
  }

  if (eventData['x-ga-platform']) context.os.name = eventData['x-ga-platform'];
  if (eventData['x-ga-os_version']) context.os.version = eventData['x-ga-os_version'];

  if (data.contextPropertiesList) {
    data.contextPropertiesList.forEach((d) => {
      if (
        ['campaign', 'page', 'app', 'device', 'network', 'os'].indexOf(d.name) !== -1 &&
        getType(d.value) === 'object'
      ) {
        for (const key in d.value) {
          context[d.name][key] = d.value[key];
        }
      } else {
        context[d.name] = d.value;
      }
    });
  }

  mappedData.context = context;

  return mappedData;
}

function addUserTraits(data, eventData, mappedData) {
  const userTraits = {};

  if (data.userTraitsObject) mergeObj(userTraits, data.userTraitsObject);
  if (data.userTraitsList) {
    data.userTraitsList.forEach((d) => (userTraits[d.name] = d.value));
  }
  if (data.customUserTraitsList) {
    data.customUserTraitsList.forEach((d) => (userTraits[d.name] = d.value));
  }

  mappedData.traits = userTraits;

  return mappedData;
}

function identifyUser(data, eventData, mappedData) {
  mappedData = addUserTraits(data, eventData, mappedData);

  return sendRequest({
    path: '/identify',
    body: mappedData
  });
}

function addGroupTraits(data, eventData, mappedData) {
  const groupTraits = {};

  mappedData.groupId = data.groupId;

  if (data.groupTraitsObject) mergeObj(groupTraits, data.groupTraitsObject);
  if (data.groupTraitsList) {
    data.groupTraitsList.forEach((d) => (groupTraits[d.name] = d.value));
  }
  if (data.customGroupTraitsList) {
    data.customGroupTraitsList.forEach((d) => (groupTraits[d.name] = d.value));
  }

  mappedData.traits = groupTraits;

  return mappedData;
}

function addUserToGroup(data, eventData, mappedData) {
  mappedData = addGroupTraits(data, eventData, mappedData);

  return sendRequest({
    path: '/group',
    body: mappedData
  });
}

function addPageProperties(data, eventData, mappedData) {
  const pageProperties = {};

  const commonPagePropertiesInContext = ['url', 'title', 'referrer', 'path', 'search', 'name'];
  // Sync with mappedData.context.page
  if (mappedData.context.page) {
    commonPagePropertiesInContext.forEach((p) => {
      if (isValidValue(mappedData.context.page[p])) {
        if (p === 'name') mappedData.name = mappedData.context.page[p];
        else pageProperties[p] = mappedData.context.page[p];
      }
    });
  }

  if (data.pageViewPageNameProperty) mappedData.name = data.pageViewPageNameProperty;
  if (data.pageViewPropertiesObject) mergeObj(pageProperties, data.pageViewPropertiesObject);
  if (data.pageViewPropertiesList) {
    data.pageViewPropertiesList.forEach((d) => (pageProperties[d.name] = d.value));
  }
  if (data.pageViewCustomPropertiesList) {
    data.pageViewCustomPropertiesList.forEach((d) => (pageProperties[d.name] = d.value));
  }

  mappedData.properties = pageProperties;

  // Sync again with mappedData.context.page
  mappedData.context.page = mappedData.context.page || {};
  commonPagePropertiesInContext.forEach((p) => {
    if (isValidValue(pageProperties[p])) {
      mappedData.context.page[p] = p !== 'name' ? pageProperties[p] : mappedData.name;
    }
  });

  return mappedData;
}

function trackPageView(data, eventData, mappedData) {
  mappedData = addPageProperties(data, eventData, mappedData);

  return sendRequest({
    path: '/page',
    body: mappedData
  });
}

function addScreenProperties(data, eventData, mappedData) {
  const screenProperties = {};

  if (data.screenViewScreenNameProperty) mappedData.name = data.screenViewScreenNameProperty;
  if (data.screenViewPropertiesObject) mergeObj(screenProperties, data.screenViewPropertiesObject);
  if (data.screenViewCustomPropertiesList) {
    data.screenViewCustomPropertiesList.forEach((d) => (screenProperties[d.name] = d.value));
  }

  mappedData.properties = screenProperties;

  return mappedData;
}

function trackScreenView(data, eventData, mappedData) {
  mappedData = addScreenProperties(data, eventData, mappedData);

  return sendRequest({
    path: '/screen',
    body: mappedData
  });
}

function mapEventName(data, eventData) {
  if (data.eventType === 'inherit') {
    const eventName = eventData.event_name;

    const gaToEventName = {
      search: 'Products Searched',
      view_item_list: 'Product List Viewed',
      select_item: 'Product Clicked',
      view_item: 'Product Viewed',
      add_to_cart: 'Product Added',
      remove_from_cart: 'Product Removed',
      share: 'Product Shared',
      view_cart: 'Cart Viewed',
      begin_checkout: 'Checkout Started',
      add_payment_info: 'Payment Info Entered',
      purchase: 'Order Completed',
      refund: 'Order Refunded',
      view_promotion: 'Promotion Viewed',
      select_promotion: 'Promotion Clicked',
      add_to_wishlist: 'Product Added to Wishlist',

      'gtm4wp.addProductToCartEEC': 'Product Added',
      'gtm4wp.productClickEEC': 'Product Clicked',
      'gtm4wp.checkoutOptionEEC': 'Checkout Started',
      'gtm4wp.orderCompletedEEC': 'Order Completed',

      first_open: 'Application Installed',
      app_update: 'Application Updated',
      app_remove: 'Application Uninstalled',
      app_exception: 'Application Crashed'
    };

    if (gaToEventName[eventName]) {
      return gaToEventName[eventName];
    }

    return eventName;
  }

  return data.eventType === 'standard' ? data.eventNameStandard : data.eventNameCustom;
}

function addEventProperties(data, eventData, mappedData) {
  const eventProperties = {};

  // App Events
  if (mappedData.context.app && mappedData.context.app.version) {
    eventProperties.version = mappedData.context.app.version;
  }
  if (eventData.previous_app_version || eventData['x-ga-previous_app_version']) {
    eventProperties.previous_version =
      eventData.previous_app_version || eventData['x-ga-previous_app_version'];
  }

  // GA4 Ecommerce Events
  const gaToEcommerceProperties = {
    search_term: 'query',
    item_list_id: 'list_id',
    item_list_name: 'category',
    promotion_id: 'promotion_id',
    promotion_name: 'name',
    creative_name: 'creative',
    creative_slot: 'position',
    transaction_id: 'order_id',
    shipping: 'shipping',
    tax: 'tax',
    coupon: 'coupon',
    payment_type: 'payment_method',
    shipping_tier: 'shipping_method',
    method: 'share_via'
  };

  let currencyFromItems;
  let valueFromItems;
  if (eventData.items && eventData.items[0]) {
    valueFromItems = 0;
    eventProperties.products = [];
    currencyFromItems = eventData.items[0].currency;
    const itemIdKey = data.itemIdKey ? data.itemIdKey : 'item_id';
    eventData.items.forEach((item) => {
      const product = {};
      if (item[itemIdKey]) product.product_id = makeString(item[itemIdKey]);
      if (item.item_name) product.name = item.item_name;
      if (item.sku) product.sku = item.sku;
      if (item.item_brand) product.brand = item.item_brand;
      if (item.item_category) product.category = item.item_category;
      if (item.item_variant) product.variant = item.item_variant;
      if (item.item_list_id) product.list_id = item.item_list_id;
      if (item.url) product.url = item.url;
      if (item.image_url) product.image_url = item.image_url;
      if (item.quantity) product.quantity = makeInteger(item.quantity);
      if (item.coupon) product.coupon = item.coupon;
      if (item.index) product.position = item.index;
      if (item.price) {
        product.price = makeString(item.price);
        valueFromItems += item.quantity ? item.quantity * item.price : item.price;
      }
      eventProperties.products.push(product);
    });
  }

  if (isValidValue(eventData.value)) eventProperties.revenue = eventData.value;
  else if (isValidValue(valueFromItems)) eventProperties.revenue = valueFromItems;

  const currency = eventData.currency || currencyFromItems;
  if (currency) eventProperties.currency = currency;

  for (const gaProperty in gaToEcommerceProperties) {
    if (!isValidValue(eventData[gaProperty])) continue;
    const property = gaToEcommerceProperties[gaProperty];
    eventProperties[property] = eventData[gaProperty];
  }

  // UI Fields
  if (data.eventPropertiesObject) mergeObj(eventProperties, data.eventPropertiesObject);
  if (data.eventPropertiesList) {
    data.eventPropertiesList.forEach((d) => (eventProperties[d.name] = d.value));
  }
  if (data.eventCustomPropertiesList) {
    data.eventCustomPropertiesList.forEach((d) => (eventProperties[d.name] = d.value));
  }

  mappedData.properties = eventProperties;

  return mappedData;
}

function trackEvent(data, eventData, mappedData) {
  mappedData.event = mapEventName(data, eventData);
  mappedData = addEventProperties(data, eventData, mappedData);

  return sendRequest({
    path: '/track',
    body: mappedData
  });
}

function getRequestBaseUrl() {
  return 'https://cdp' + (data.apiRegion === 'eu' ? '-eu' : '') + '.customer.io/v1';
}

function generateRequestHeaders() {
  return {
    Authorization: 'Basic ' + toBase64(data.apiKey + ':'),
    'Content-Type': 'application/json'
  };
}

function areThereRequiredFieldsMissing(requestPath, payload) {
  const requiredCommonFields = ['userId', 'anonymousId'];
  const requiredFieldsByRequestPath = {
    '/group': ['groupId'],
    '/track': ['event']
  };

  const commonFieldsMissing = ['userId', 'anonymousId'].every((p) => !isValidValue(payload[p]));
  if (commonFieldsMissing) return requiredCommonFields;

  const fieldsMissing = (requiredFieldsByRequestPath[requestPath] || []).some(
    (p) => !isValidValue(payload[p])
  );
  if (fieldsMissing) return requiredFieldsByRequestPath[requestPath];
}

function sendRequest(requestData) {
  const missingFields = areThereRequiredFieldsMissing(requestData.path, requestData.body);
  if (missingFields) {
    log({
      Name: 'Customer.io',
      Type: 'Message',
      TraceId: traceId,
      EventName: requestData.path,
      Message: 'Request was not sent.',
      Reason: 'One or more required properties are missing: ' + missingFields.join(' or ')
    });

    return data.gtmOnFailure();
  }

  const requestUrl = getRequestBaseUrl() + requestData.path;

  log({
    Name: 'Customer.io',
    Type: 'Request',
    TraceId: traceId,
    EventName: requestData.path,
    RequestMethod: 'POST',
    RequestUrl: requestUrl,
    RequestBody: requestData.body
  });

  return sendHttpRequest(
    requestUrl,
    (statusCode, headers, body) => {
      log({
        Name: 'Customer.io',
        Type: 'Response',
        TraceId: traceId,
        EventName: requestData.path,
        ResponseStatusCode: statusCode,
        ResponseHeaders: headers,
        ResponseBody: body
      });

      if (!data.useOptimisticScenario) {
        let parsedBody = {};
        if (body) parsedBody = JSON.parse(body);

        if (
          statusCode >= 200 &&
          statusCode < 400 &&
          getType(parsedBody) === 'object' &&
          parsedBody.success
        ) {
          data.gtmOnSuccess();
        } else {
          data.gtmOnFailure();
        }
      }
    },
    {
      headers: generateRequestHeaders(),
      method: 'POST'
    },
    JSON.stringify(requestData.body)
  );
}

/**********************************************************************************************/
// Helpers

function random() {
  return generateRandom(1000000000000000, 10000000000000000) / 10000000000000000;
}

function generateUUID() {
  function s(n) {
    return h((random() * (1 << (n << 2))) ^ getTimestampMillis()).slice(-n);
  }
  function h(n) {
    return (n | 0).toString(16);
  }
  return [
    s(4) + s(4),
    s(4),
    '4' + s(3),
    h(8 | (random() * 4)) + s(3),
    getTimestampMillis().toString(16).slice(-10) + s(2)
  ]
    .join('-')
    .toUpperCase();
}

function isUIFieldTrue(field) {
  return [true, 'true'].indexOf(field) !== -1;
}

function isValidValue(value) {
  const valueType = getType(value);
  return valueType !== 'null' && valueType !== 'undefined' && value !== '';
}

function mergeObj(target, source) {
  for (const key in source) {
    if (source.hasOwnProperty(key)) target[key] = source[key];
  }
  return target;
}

function isConsentGivenOrNotRequired() {
  if (data.adStorageConsent !== 'required') return true;
  if (eventData.consent_state) return !!eventData.consent_state.ad_storage;
  const xGaGcs = eventData['x-ga-gcs'] || ''; // x-ga-gcs is a string like "G110"
  return xGaGcs[2] === '1';
}

function log(rawDataToLog) {
  const logDestinationsHandlers = {};
  if (determinateIsLoggingEnabled()) logDestinationsHandlers.console = logConsole;
  if (determinateIsLoggingEnabledForBigQuery()) logDestinationsHandlers.bigQuery = logToBigQuery;

  // Key mappings for each log destination
  const keyMappings = {
    // No transformation for Console is needed.
    bigQuery: {
      Name: 'tag_name',
      Type: 'type',
      TraceId: 'trace_id',
      EventName: 'event_name',
      RequestMethod: 'request_method',
      RequestUrl: 'request_url',
      RequestBody: 'request_body',
      ResponseStatusCode: 'response_status_code',
      ResponseHeaders: 'response_headers',
      ResponseBody: 'response_body'
    }
  };

  for (const logDestination in logDestinationsHandlers) {
    const handler = logDestinationsHandlers[logDestination];
    if (!handler) continue;

    const mapping = keyMappings[logDestination];
    const dataToLog = mapping ? {} : rawDataToLog;
    // Map keys based on the log destination
    if (mapping) {
      for (const key in rawDataToLog) {
        const mappedKey = mapping[key] || key; // Fallback to original key if no mapping exists
        dataToLog[mappedKey] = rawDataToLog[key];
      }
    }

    handler(dataToLog);
  }
}

function logConsole(dataToLog) {
  logToConsole(JSON.stringify(dataToLog));
}

function logToBigQuery(dataToLog) {
  const connectionInfo = {
    projectId: data.logBigQueryProjectId,
    datasetId: data.logBigQueryDatasetId,
    tableId: data.logBigQueryTableId
  };

  // timestamp is required.
  dataToLog.timestamp = getTimestampMillis();

  // Columns with type JSON need to be stringified.
  ['request_body', 'response_headers', 'response_body'].forEach((p) => {
    // GTM Sandboxed JSON.parse returns undefined for malformed JSON but throws post-execution, causing execution failure.
    // If fixed, could use: dataToLog[p] = JSON.stringify(JSON.parse(dataToLog[p]) || dataToLog[p]);
    dataToLog[p] = JSON.stringify(dataToLog[p]);
  });

  // assertApi doesn't work for 'BigQuery.insert()'. It's needed to convert BigQuery into a function when testing.
  // Ref: https://gtm-gear.com/posts/gtm-templates-testing/
  const bigquery =
    getType(BigQuery) === 'function' ? BigQuery() /* Only during Unit Tests */ : BigQuery;
  bigquery.insert(connectionInfo, [dataToLog], { ignoreUnknownValues: true });
}

function determinateIsLoggingEnabled() {
  const containerVersion = getContainerVersion();
  const isDebug = !!(
    containerVersion &&
    (containerVersion.debugMode || containerVersion.previewMode)
  );

  if (!data.logType) {
    return isDebug;
  }

  if (data.logType === 'no') {
    return false;
  }

  if (data.logType === 'debug') {
    return isDebug;
  }

  return data.logType === 'always';
}

function determinateIsLoggingEnabledForBigQuery() {
  if (data.bigQueryLogType === 'no') return false;
  return data.bigQueryLogType === 'always';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trace-id"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "referer"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdp.customer.io/v1/*"
              },
              {
                "type": 1,
                "string": "https://cdp-eu.customer.io/v1/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_bigquery",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedTables",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "projectId"
                  },
                  {
                    "type": 1,
                    "string": "datasetId"
                  },
                  {
                    "type": 1,
                    "string": "tableId"
                  },
                  {
                    "type": 1,
                    "string": "operation"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ajs_anonymous_id"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ajs_anonymous_id"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Request Endpoint is correctly set based on the selected region
  code: |-
    setType('trackEvent');

    // us

    mockData.apiRegion = 'us';

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).contains('cdp.customer.io');
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();

    // eu

    mockData.apiRegion = 'eu';

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).contains('cdp-eu.customer.io');
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: Request Headers are correctly set
  code: |-
    const toBase64 = require('toBase64');

    setType('trackEvent');

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestOptions).isEqualTo({
        headers: {
          Authorization: 'Basic ' + toBase64(mockData.apiKey + ':'),
          'Content-Type': 'application/json'
        },
        method: 'POST'
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: Request is not sent when User ID and Anonymous ID are missing
  code: |-
    setType('trackEvent');

    mockData.anonymousId = undefined;
    mockData.userId = undefined;

    runCode(mockData);

    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('gtmOnFailure').wasCalled();
    assertApi('sendHttpRequest').wasNotCalled();
- name: Anonymous ID cookie is NOT set and not used when the option is not active
  code: |-
    setType('trackEvent');
    mockData.generateAnonymousIdCookie = undefined;

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedBody = JSON.parse(requestBody);
      assertThat(parsedBody.anonymousId).isEqualTo(expectedAnonymousId);
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('setCookie').wasNotCalled();
- name: Anonymous ID cookie is NOT set and not used when the option is active, but
    Anonymous ID was set on UI field
  code: |-
    setType('trackEvent');
    mockData.generateAnonymousIdCookie = true;

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedBody = JSON.parse(requestBody);
      assertThat(parsedBody.anonymousId).isEqualTo(expectedAnonymousId);
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('setCookie').wasNotCalled();
- name: Anonymous ID cookie is set when the option is active and Anonymous ID was
    NOT set on UI field (Random)
  code: |+
    setType('trackEvent');
    mockData.anonymousId = undefined;
    mockData.generateAnonymousIdCookie = true;

    let anonymousId;
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedBody = JSON.parse(requestBody);
      anonymousId = parsedBody.anonymousId;
      assertThat(anonymousId).isDefined();
      assertThat(anonymousId).hasLength(36);
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('setCookie').wasCalledWith('ajs_anonymous_id', anonymousId, {
      domain: mockData.anonIdCookieDomain || 'auto',
      samesite: 'Lax',
      path: '/',
      secure: true,
      httpOnly: false,
      'max-age': 60 * 60 * 24 * (makeInteger(mockData.anonIdCookieExpiration) || 365)
    });

- name: Anonymous ID cookie is set when the option is active and Anonymous ID was
    NOT set on UI field (Read from Cookie)
  code: |
    setType('trackEvent');
    mockData.anonymousId = undefined;
    mockData.generateAnonymousIdCookie = true;

    const expectedAnonymousIdFromCookie = 'expectedAnonymousIdFromCookie';
    mock('getCookieValues', [expectedAnonymousIdFromCookie]);

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedBody = JSON.parse(requestBody);
      assertThat(parsedBody.anonymousId).isEqualTo(expectedAnonymousIdFromCookie);
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('setCookie').wasCalledWith('ajs_anonymous_id', expectedAnonymousIdFromCookie, {
      domain: mockData.anonIdCookieDomain || 'auto',
      samesite: 'Lax',
      path: '/',
      secure: true,
      httpOnly: false,
      'max-age': 60 * 60 * 24 * (makeInteger(mockData.anonIdCookieExpiration) || 365)
    });
- name: IP Address is correctly redact if option is set
  code: |-
    setType('trackEvent');
    mockData.redactIpAddress = true;

    const expectedRedactedIpAddress = '0.0.0.0';

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      const parsedBody = JSON.parse(requestBody);
      assertThat(parsedBody.context.ip).isEqualTo(expectedRedactedIpAddress);
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Track Event] Request is NOT sent when Event Name is missing'
  code: |-
    setType('trackEvent');

    mockData.eventNameCustom = undefined;

    runCode(mockData);

    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('gtmOnFailure').wasCalled();
    assertApi('sendHttpRequest').wasNotCalled();
- name: '[Track Event] Request is successfully built and sent'
  code: |-
    setType('trackEvent');
    mockData.eventType = 'inherit';
    setGetAllEventData({
      event_name: 'purchase',
      items: [
        {
          item_id: 'SKU_12345',
          item_name: 'Stan and Friends Tee',
          affiliation: 'Google Merchandise Store',
          coupon: 'SUMMER_FUN',
          discount: 2.22,
          index: 0,
          item_brand: 'Google',
          item_category: 'Apparel',
          item_category2: 'Adult',
          item_category3: 'Shirts',
          item_category4: 'Crew',
          item_category5: 'Short sleeve',
          item_list_id: 'related_products',
          item_list_name: 'Related Products',
          item_variant: 'green',
          location_id: 'ChIJIQBpAG2ahYAR_6128GcTUEo',
          price: 10.01,
          quantity: 3
        },
        {
          item_id: 'SKU_12346',
          item_name: "Google Grey Women's Tee",
          affiliation: 'Google Merchandise Store',
          coupon: 'SUMMER_FUN',
          discount: 3.33,
          index: 1,
          item_brand: 'Google',
          item_category: 'Apparel',
          item_category2: 'Adult',
          item_category3: 'Shirts',
          item_category4: 'Crew',
          item_category5: 'Short sleeve',
          item_list_id: 'related_products',
          item_list_name: 'Related Products',
          item_variant: 'gray',
          location_id: 'ChIJIQBpAG2ahYAR_6128GcTUEo',
          price: 21.01,
          promotion_id: 'P_12345',
          promotion_name: 'Summer Sale',
          quantity: 2
        }
      ],
      transaction_id: 'T_12345',
      value: 72.05,
      tax: 3.6,
      shipping: 5.99,
      coupon: 'SUMMER_SALE',
    });

    const expectedRequestUrl = 'https://cdp.customer.io/v1/track';
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo(expectedRequestUrl);
      const parsedBody = JSON.parse(requestBody);
        assertThat(parsedBody).isEqualTo({
        userId: expectedUserId,
        anonymousId: expectedAnonymousId,
        context: {
          campaign: {},
          page: {
            title: 'Example Domain',
            url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234'
          },
          app: {},
          device: {},
          network: {},
          os: {},
          library: { name: 'gtmserver-stape', version: '1.0' },
          ip: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',
          userAgent:
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36',
          locale: 'en-us'
        },
        event: 'Order Completed',
        properties: {
          products: [
            {
              product_id: 'SKU_12345',
              name: 'Stan and Friends Tee',
              brand: 'Google',
              category: 'Apparel',
              variant: 'green',
              list_id: 'related_products',
              quantity: 3,
              coupon: 'SUMMER_FUN',
              price: '10.01'
            },
            {
              product_id: 'SKU_12346',
              name: "Google Grey Women's Tee",
              brand: 'Google',
              category: 'Apparel',
              variant: 'gray',
              list_id: 'related_products',
              quantity: 2,
              coupon: 'SUMMER_FUN',
              position: 1,
              price: '21.01'
            }
          ],
          revenue: 72.05,
          order_id: 'T_12345',
          shipping: 5.99,
          tax: 3.6,
          coupon: 'SUMMER_SALE'
        }
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Add User to Group] Request is NOT sent when Group ID is missing'
  code: |-
    setType('addUserToGroup');

    mockData.groupId = undefined;

    runCode(mockData);

    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('gtmOnFailure').wasCalled();
    assertApi('sendHttpRequest').wasNotCalled();
- name: '[Add User to Group] Request is successfully built and sent'
  code: |-
    setType('addUserToGroup');

    const groupTraitsObject = { abc: 'abc' };
    const groupTraitsList = [{ name: 'avatar', value: 'foobar' }];
    const customGroupTraitsList = [{ name: 'test', value: 'test' }];

    let expectedGroupTraits = mergeObj({}, groupTraitsObject);
    expectedGroupTraits = mergeObj(expectedGroupTraits, groupTraitsList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));
    expectedGroupTraits = mergeObj(expectedGroupTraits, customGroupTraitsList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));

    const expectedGroupId = '123';
    mockData.groupId = expectedGroupId;
    mockData.groupTraitsObject = groupTraitsObject;
    mockData.groupTraitsList = groupTraitsList;
    mockData.customGroupTraitsList = customGroupTraitsList;

    const expectedRequestUrl = 'https://cdp.customer.io/v1/group';
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo(expectedRequestUrl);
      const parsedBody = JSON.parse(requestBody);
        assertThat(parsedBody).isEqualTo({
        userId: expectedUserId,
        anonymousId: expectedAnonymousId,
        context: {
          campaign: {},
          page: {
            title: 'Example Domain',
            url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234'
          },
          app: {},
          device: {},
          network: {},
          os: {},
          library: { name: 'gtmserver-stape', version: '1.0' },
          ip: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',
          userAgent:
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36',
          locale: 'en-us'
        },
        groupId: expectedGroupId,
        traits: expectedGroupTraits
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Track Page View] Request is successfully built and sent'
  code: |-
    setType('trackPageView');

    const pageViewPropertiesObject = { abc: 'abc' };
    const pageViewPropertiesList = [{ name: 'title', value: 'foobar' }];
    const pageViewCustomPropertiesList = [{ name: 'test', value: 'test' }];

    let expectedpageViewProperties = mergeObj({}, pageViewPropertiesObject);
    expectedpageViewProperties = mergeObj(expectedpageViewProperties, pageViewPropertiesList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));
    expectedpageViewProperties = mergeObj(expectedpageViewProperties, pageViewCustomPropertiesList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));

    const expectedPageViewPageNameProperty = 'test';
    mockData.pageViewPageNameProperty = expectedPageViewPageNameProperty;
    mockData.pageViewPropertiesObject = pageViewPropertiesObject;
    mockData.pageViewPropertiesList = pageViewPropertiesList;
    mockData.pageViewCustomPropertiesList = pageViewCustomPropertiesList;

    const expectedRequestUrl = 'https://cdp.customer.io/v1/page';
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo(expectedRequestUrl);
      const parsedBody = JSON.parse(requestBody);
        assertThat(parsedBody).isEqualTo({
        userId: expectedUserId,
        anonymousId: expectedAnonymousId,
        context: {
          campaign: {},
          page: {
            title: 'foobar',
            url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234'
          },
          app: {},
          device: {},
          network: {},
          os: {},
          library: { name: 'gtmserver-stape', version: '1.0' },
          ip: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',
          userAgent:
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36',
          locale: 'en-us'
        },
        name: 'test',
        properties: {
          url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234',
          title: 'foobar',
          abc: 'abc',
          test: 'test'
        }
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Track Screen View] Request is successfully built and sent'
  code: |-
    setType('trackScreenView');

    const screenViewPropertiesObject = { abc: 'abc' };
    const screenViewCustomPropertiesList = [{ name: 'test', value: 'test' }];

    let expectedScreenViewProperties = mergeObj({}, screenViewPropertiesObject);
    expectedScreenViewProperties = mergeObj(expectedScreenViewProperties, screenViewCustomPropertiesList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));

    const expectedScreenViewScreenNameProperty = 'test';
    mockData.screenViewScreenNameProperty = expectedScreenViewScreenNameProperty;
    mockData.screenViewPropertiesObject = screenViewPropertiesObject;
    mockData.screenViewCustomPropertiesList = screenViewCustomPropertiesList;

    const expectedRequestUrl = 'https://cdp.customer.io/v1/screen';
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo(expectedRequestUrl);
      const parsedBody = JSON.parse(requestBody);
        assertThat(parsedBody).isEqualTo({
        userId: expectedUserId,
        anonymousId: expectedAnonymousId,
        context: {
          campaign: {},
          page: {
            title: 'Example Domain',
            url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234'
          },
          app: {},
          device: {},
          network: {},
          os: {},
          library: { name: 'gtmserver-stape', version: '1.0' },
          ip: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',
          userAgent:
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36',
          locale: 'en-us'
        },
        name: expectedScreenViewScreenNameProperty,
        properties: expectedScreenViewProperties
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: '[Identify User] Request is successfully built and sent'
  code: |-
    setType('identifyUser');

    const userTraitsObject = { abc: 'abc' };
    const userTraitsList = [{ name: 'avatar', value: 'foobar' }];
    const customUserTraitsList = [{ name: 'test', value: 'test' }];

    let expectedUserTraits = mergeObj({}, userTraitsObject);
    expectedUserTraits = mergeObj(expectedUserTraits, userTraitsList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));
    expectedUserTraits = mergeObj(expectedUserTraits, customUserTraitsList.reduce((acc, curr) => {
      acc[curr.name] = curr.value;
      return acc;
    }, {}));

    mockData.userTraitsObject = userTraitsObject;
    mockData.userTraitsList = userTraitsList;
    mockData.customUserTraitsList = customUserTraitsList;

    const expectedRequestUrl = 'https://cdp.customer.io/v1/identify';
    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      assertThat(requestUrl).isEqualTo(expectedRequestUrl);
      const parsedBody = JSON.parse(requestBody);
        assertThat(parsedBody).isEqualTo({
        userId: expectedUserId,
        anonymousId: expectedAnonymousId,
        context: {
          campaign: {},
          page: {
            title: 'Example Domain',
            url: 'https://example.com/?test=1i23i21j3&ji12i4=-234234'
          },
          app: {},
          device: {},
          network: {},
          os: {},
          library: { name: 'gtmserver-stape', version: '1.0' },
          ip: '2804:14d:c096:8dd6:311c:8c00:e6c:e33',
          userAgent:
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36',
          locale: 'en-us'
        },
        traits: expectedUserTraits
      });
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
    assertApi('gtmOnFailure').wasNotCalled();
- name: Should log to console, if the 'Always log to console' option is selected
  code: "setType('trackEvent');\nmockData.logType = 'always';\n\nconst expectedDebugMode\
    \ = true;\nmock('getContainerVersion', () => {\n  return {\n    debugMode: expectedDebugMode\n\
    \  };\n}); \n\nmock('logToConsole', (logData) => {\n  const parsedLogData = JSON.parse(logData);\n\
    \  requiredConsoleKeys.forEach(p => assertThat(parsedLogData[p]).isDefined());\n\
    });\n\nmock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody)\
    \ => {\n  callback(200, {}, JSON.stringify({ success: true }));\n});\n\nrunCode(mockData);\n\
    \nassertApi('logToConsole').wasCalled();\n"
- name: Should log to console, if the 'Log during debug and preview' option is selected
    AND is on preview mode
  code: |
    setType('trackEvent');
    mockData.logType = 'debug';

    const expectedDebugMode = true;
    mock('getContainerVersion', () => {
      return {
        debugMode: expectedDebugMode
      };
    });

    mock('logToConsole', (logData) => {
      const parsedLogData = JSON.parse(logData);
      requiredConsoleKeys.forEach(p => assertThat(parsedLogData[p]).isDefined());
    });

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('logToConsole').wasCalled();
- name: Should NOT log to console, if the 'Log during debug and preview' option is
    selected AND is NOT on preview mode
  code: "setType('trackEvent');\nmockData.logType = 'debug';\n\nconst expectedDebugMode\
    \ = false;\nmock('getContainerVersion', () => {\n  return {\n    debugMode: expectedDebugMode\n\
    \  };\n}); \n\nmock('sendHttpRequest', (requestUrl, callback, requestOptions,\
    \ requestBody) => {\n  callback(200, {}, JSON.stringify({ success: true }));\n\
    });\n\nrunCode(mockData);\n\nassertApi('logToConsole').wasNotCalled();\n"
- name: Should NOT log to console, if the 'Do not log' option is selected
  code: |
    setType('trackEvent');
    mockData.logType = 'no';

    mock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody) => {
      callback(200, {}, JSON.stringify({ success: true }));
    });

    runCode(mockData);

    assertApi('logToConsole').wasNotCalled();
- name: Should log to BQ, if the 'Log to BigQuery' option is selected
  code: "setType('trackEvent');\nmockData.bigQueryLogType = 'always';\n\n// assertApi\
    \ doesn't work for 'BigQuery.insert()'.\n// Ref: https://gtm-gear.com/posts/gtm-templates-testing/\n\
    mock('BigQuery', () => {\n  return { \n    insert: (connectionInfo, rows, options)\
    \ => { \n      assertThat(connectionInfo).isDefined();\n      assertThat(rows).isArray();\n\
    \      assertThat(rows).hasLength(1);\n      requiredBqKeys.forEach(p => assertThat(rows[0][p]).isDefined());\n\
    \      assertThat(options).isEqualTo(expectedBqOptions);\n      return Promise.create((resolve,\
    \ reject) => {\n        resolve();\n      });\n    }\n  };\n});\n\nmock('sendHttpRequest',\
    \ (requestUrl, callback, requestOptions, requestBody) => {\n  callback(200, {},\
    \ JSON.stringify({ success: true }));\n});\n\nrunCode(mockData);"
- name: Should NOT log to BQ, if the 'Do not log to BigQuery' option is selected
  code: "setType('trackEvent');\nmockData.bigQueryLogType = 'no';\n\n// assertApi\
    \ doesn't work for 'BigQuery.insert()'.\n// Ref: https://gtm-gear.com/posts/gtm-templates-testing/\n\
    mock('BigQuery', () => {\n  return { \n    insert: (connectionInfo, rows, options)\
    \ => { \n      fail('BigQuery.insert should not have been called.');\n      return\
    \ Promise.create((resolve, reject) => {\n        resolve();\n      });\n    }\n\
    \  };\n});\n\nmock('sendHttpRequest', (requestUrl, callback, requestOptions, requestBody)\
    \ => {\n  callback(200, {}, JSON.stringify({ success: true }));\n});\n\nrunCode(mockData);"
setup: "const Promise = require('Promise');\nconst JSON = require('JSON');\nconst\
  \ makeInteger = require('makeInteger');\n\nconst mergeObj = (target, source) =>\
  \ {\n  for (const key in source) {\n    if (source.hasOwnProperty(key)) target[key]\
  \ = source[key];\n  }\n  return target;\n};\n\nconst setGetAllEventData = (objToBeMerged)\
  \ => {\n  mock('getAllEventData', mergeObj({\n    \"x-ga-protocol_version\": \"\
  2\",\n    \"x-ga-measurement_id\": \"G-123ABC\",\n    \"x-ga-gtm_version\": \"45je55e1za200\"\
  ,\n    \"x-ga-page_id\": 1747422523211,\n    \"x-ga-gcd\": \"13l3l3l3l1l1\",\n \
  \   \"x-ga-npa\": \"0\",\n    \"x-ga-dma\": \"0\",\n    \"x-ga-mp2-tag_exp\": \"\
  101509157~103116025~103130498~103130500~103136993~103136995~103200001~103207802~103211513~103233427~103252644~103252646~103263073~103301114~103301116\"\
  ,\n    \"client_id\": \"AUJctU7H7hBB/aMuhE4pKwGu5DWDdklg5abyyyn8i/I=.1747154479\"\
  ,\n    \"x-ga-ecid\": \"1294673677\",\n    \"language\": \"en-us\",\n    \"screen_resolution\"\
  : \"1512x982\",\n    \"event_location\": { \"country\": \"BR\", \"region\": \"SP\"\
  \ },\n    \"client_hints\": {\n      \"architecture\": \"arm\",\n      \"bitness\"\
  : \"64\",\n      \"full_version_list\": [\n        { \"brand\": \"Chromium\", \"\
  version\": \"136.0.7103.93\" },\n        { \"brand\": \"Google Chrome\", \"version\"\
  : \"136.0.7103.93\" },\n        { \"brand\": \"Not.A/Brand\", \"version\": \"99.0.0.0\"\
  \ }\n      ],\n      \"mobile\": false,\n      \"model\": \"\",\n      \"platform\"\
  : \"macOS\",\n      \"platform_version\": \"15.2.0\",\n      \"wow64\": false,\n\
  \      \"brands\": [\n        { \"brand\": \"Chromium\", \"version\": \"136\" },\n\
  \        { \"brand\": \"Google Chrome\", \"version\": \"136\" },\n        { \"brand\"\
  : \"Not.A/Brand\", \"version\": \"99\" }\n      ]\n    },\n    \"x-ga-are\": \"\
  1\",\n    \"x-ga-mp2-frm\": \"0\",\n    \"x-ga-pscdl\": \"noapi\",\n    \"x-ga-system_properties\"\
  : { \"eu\": [34], \"tu\": \"BA\", \"ss\": \"1\", \"ee\": true },\n    \"x-sst-system_properties\"\
  : {\n      \"etld\": \"google.com.br\",\n      \"tft\": \"1747422523211\",\n   \
  \   \"lpc\": \"60493049\",\n      \"navt\": \"r\",\n      \"ude\": \"0\",\n    \
  \  \"sw_exp\": \"1\",\n      \"request_start_time_ms\": 1747422524851\n    },\n\
  \    \"x-ga-request_count\": 1,\n    \"ga_session_id\": \"1747422523\",\n    \"\
  ga_session_number\": 3,\n    \"x-ga-mp2-seg\": \"0\",\n    \"page_location\": \"\
  https://example.com/?test=1i23i21j3&ji12i4=-234234\",\n    \"page_title\": \"Example\
  \ Domain\",\n    \"event_name\": \"page_view\",\n    \"x-ga-tfd\": 5784,\n    \"\
  ip_override\": \"2804:14d:c096:8dd6:311c:8c00:e6c:e33\",\n    \"user_agent\": \"\
  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like\
  \ Gecko) Chrome/136.0.0.0 Safari/537.36\"\n  }, objToBeMerged || {}));\n};\nsetGetAllEventData();\n\
  \nconst expectedEventName = 'purchase';\nconst expectedApiKey = '123456789';\nconst\
  \ expectedUserId = 'expectedUserId';\nconst expectedAnonymousId = 'expectedAnonymousId';\n\
  const expectedApiRegion = 'us';\n\nconst expectedBigQuerySettings = {\n  logBigQueryProjectId:\
  \ 'logBigQueryProjectId',\n  logBigQueryDatasetId: 'logBigQueryDatasetId',\n  logBigQueryTableId:\
  \ 'logBigQueryTableId'\n};\nconst requiredConsoleKeys = ['Type', 'TraceId', 'Name'];\n\
  const requiredBqKeys = ['timestamp', 'type', 'trace_id', 'tag_name'];\nconst expectedBqOptions\
  \ = { ignoreUnknownValues: true };\n\nconst mockData = {\n  apiKey: expectedApiKey,\n\
  \  userId: expectedUserId,\n  anonymousId: expectedAnonymousId,\n  apiRegion: expectedApiRegion,\n\
  \  logBigQueryProjectId: expectedBigQuerySettings.logBigQueryProjectId,\n  logBigQueryDatasetId:\
  \ expectedBigQuerySettings.logBigQueryDatasetId,\n  logBigQueryTableId: expectedBigQuerySettings.logBigQueryTableId\n\
  };\n\nconst setType = (type) => {\n  const types = {\n    trackEvent: {\n      type:\
  \ 'trackEvent',\n      eventType: 'custom',\n      eventNameCustom: 'expectedEventName'\n\
  \    },\n    trackPageView: {\n      type: 'trackPageView'\n    },\n    trackScreenView:\
  \ {\n      type: 'trackScreenView'\n    },\n    identifyUser: {\n      type: 'identifyUser'\n\
  \    },\n    addUserToGroup: {\n      type: 'addUserToGroup'\n    }\n  };\n  \n\
  \  mergeObj(mockData, types[type]);\n};"


___NOTES___

Created on 5/19/2025, 9:48:36 AM

